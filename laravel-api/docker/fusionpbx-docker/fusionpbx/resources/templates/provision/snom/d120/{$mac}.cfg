<?xml version="1.0" encoding="utf-8"?>
<settings>
<phone-settings e="2">
<timezone perm="R">{$snom_time_zone}</timezone>
<ntp_server perm="R">{$ntp_server_primary}</ntp_server>
<language perm="!">{$snom_language}</language>
<tone_scheme perm="R">{$snom_tonescheme}</tone_scheme>
<date_us_format perm="R">{if $snom_time_format == 'us'}on{else}off{/if}</date_us_format>
<dialnumber_us_format perm="R">{if $snom_time_format == 'us'}on{else}off{/if}</dialnumber_us_format>
<admin_mode_password perm="R">{$admin_password}</admin_mode_password>
<admin_mode_password_confirm perm="R">{$admin_password}</admin_mode_password_confirm>
<http_user perm="R">{$admin_name}</http_user>
<http_pass perm="R">{$admin_password}</http_pass>
<http_client_user perm="R">{$http_auth_username}</http_client_user>
<http_client_pass perm="R">{$http_auth_password}</http_client_pass>

{if isset ($snom_green_blf)}
{if $snom_green_blf == "on"}
<led_on perm="R">idle ON BUSY IN_A_CALL CALLING IN_A_MEETING URGENT_INTERRUPTIONS_ONLY DND UNAVAILABLE ACTIVE INACTIVE BE_RIGHT_BACK AWAY SEIZED CONNECTED ON_HOLD OFFHOOK RINGBACK I-Am-Ready AVAILABLE I-Am-Busy PhoneHasCall PhoneHasMissedCalls</led_on>
<led_green perm="R">idle AVAILABLE  I-Am-Ready I-Am-Almost-Ready</led_green>
{else if $snom_green_blf == "default" || $snom_green_blf == "off"}
<led_on perm="R">ON IN_A_CALL CALLING IN_A_MEETING URGENT_INTERRUPTIONS_ONLY BUSY I-Am-Busy DND_ALL DND_SELF ACTIVE INACTIVE BE_RIGHT_BACK SEIZED CONNECTED ON_HOLD OFFHOOK RINGBACK I-Am-Ready AWAY AVAILABLE AVAILABLE_ON_MOBILE AVAILABLE_AT_DESK PhoneHasCall PhoneHasMissedCalls CurrentIdentityHasVoiceMessages PhoneHasVoiceMessages seized_local seized_remote active_local active_remote</led_on>
<led_green perm="R">AVAILABLE AVAILABLE_ON_MOBILE AVAILABLE_AT_DESK I-Am-Ready I-Am-Almost-Ready seized_local alerting_local active_local held_local</led_green>
{/if}
{/if}

<update_policy perm="R">{$snom_update_policy}</update_policy>
<setting_server perm="R">https://{$domain_name}{$project_path}/app/provision/index.php?mac={$mac}</setting_server>

<firmware perm="R">{$snom_firmware_path}</firmware>
{if isset ($snom_monitor_calls)}<goto_monitor_state_on_line_activity perm="R">{$snom_monitor_calls}</goto_monitor_state_on_line_activity>{/if}
<settings_refresh_timer perm="R">{if isset ($snom_resync_peiod)}0{else}{$snom_resync_peiod}{/if}</settings_refresh_timer>

{if isset ($snom_background_image)}
<custom_bg_image_url perm="R">{$snom_background_image}</custom_bg_image_url>
{/if}

{foreach $lines as $row}
<!-- line {$row.line_number}: -->
<user_active idx="{$row.line_number}" perm="R">on</user_active>
<user_realname idx="{$row.line_number}" perm="R">{$row.display_name}</user_realname>
<user_name idx="{$row.line_number}" perm="R">{$row.user_id}</user_name>
<user_pass idx="{$row.line_number}" perm="R">{$row.password}</user_pass>
<user_host idx="{$row.line_number}" perm="R">{$row.server_address}</user_host>
{if $row.sip_transport neq "dns srv"}<user_outbound idx="{$row.line_number}" perm="R">{if $row.outbound_proxy neq ''}{$row.outbound_proxy}{else}{$row.server_address}{/if};transport={$row.sip_transport}</user_outbound>{/if}
{if $row.auth_id neq ''}<user_pname idx="{$row.line_number}" perm="R">{$row.auth_id}</user_pname>{/if}
<user_server_type idx="{$row.line_number}" perm="R">Default</user_server_type>
<user_srtp idx="{$row.line_number}" perm="R">{$snom_srtp}</user_srtp>
<user_mailbox idx="{$row.line_number}" perm="R">*97</user_mailbox>
<user_dtmf_info idx="{$row.line_number}" perm="R">{$snom_dtmf_mode}</user_dtmf_info>
<user_ice idx="{$row.line_number}" perm="R">off</user_ice>
<stun_server idx="{$row.line_number}" perm="R"></stun_server>
<codec_priority_list idx="{$row.line_number}" perm="R">{if $snom_dtmf_mode == 'on'}telephone-event,{/if}g722,pcmu,pcma,g729</codec_priority_list>
<user_expiry idx="{$row.line_number}" perm="R">{$register_expires_{$row.line_number}}</user_expiry>
<retry_after_failed_subscribe idx="{$row.line_number}" perm="R">1</retry_after_failed_subscribe>
{/foreach}
</phone-settings>

<functionKeys>
{foreach $keys["expansion"] as $row}
	{if $row.device_key_line == "" || $row.device_key_line == "0"}
		{if $row.device_key_type == "line"}
			<fkey idx="{$row.device_key_id-1+$regularKeys+$isD3XX*126}" context="active" label="{$row.device_key_label}" perm="R">line</fkey>
		{else if $row.device_key_type == "blf"}
			<fkey idx="{$row.device_key_id-1+$regularKeys+$isD3XX*126}" context="active" label="{$row.device_key_label}" perm="R">blf &lt;sip:{$row.device_key_value}@{$domain_name};user=phone&gt;|**</fkey>
		{else}
			<fkey idx="{$row.device_key_id-1+$regularKeys+$isD3XX*126}" context="active" label="{$row.device_key_label}" perm="R">{$row.device_key_type} {$row.device_key_value} {$row.device_key_extension}</fkey>
		{/if}
	{else}
		{if $row.device_key_type == "line"}
			<fkey idx="{$row.device_key_id-1+$regularKeys+$isD3XX*126}" context="active" label="{$row.device_key_label}" perm="R">line</fkey>
		{else if $row.device_key_type == "blf"}
			<fkey idx="{$row.device_key_id-1+$regularKeys+$isD3XX*126}" context="{$row.device_key_line}" label="{$row.device_key_label}" perm="R">blf &lt;sip:{$row.device_key_value}@{$domain_name};user=phone&gt;|**</fkey>
		{else}
			<fkey idx="{$row.device_key_id-1+$regularKeys+$isD3XX*126}" context="{$row.device_key_line}" label="{$row.device_key_label}" perm="R">{$row.device_key_type} {$row.device_key_value} {$row.device_key_extension}</fkey>
		{/if}
	{/if}
{/foreach}
{foreach $keys["line"] as $row}
	{if $row.device_key_id <= $regularKeys}
		{if $row.device_key_line == "" || $row.device_key_line == "0"}
			{if $row.device_key_type == "line"}
				<fkey idx="{$row.device_key_id-1}" context="active" label="{$row.device_key_label}" perm="R">line</fkey>
			{else if $row.device_key_type == "blf"}
				<fkey idx="{$row.device_key_id-1}" context="active" label="{$row.device_key_label}" perm="R">blf &lt;sip:{$row.device_key_value}@{$domain_name};user=phone&gt;|**</fkey>
			{else}
				<fkey idx="{$row.device_key_id-1}" context="active" label="{$row.device_key_label}" perm="R">{$row.device_key_type} {$row.device_key_value} {$row.device_key_extension}</fkey>
			{/if}
		{else}
			{if $row.device_key_type == "line"}
				<fkey idx="{$row.device_key_id-1}" context="active" label="{$row.device_key_label}" perm="R">line</fkey>
			{else if $row.device_key_type == "blf"}
				<fkey idx="{$row.device_key_id-1}" context="{$row.device_key_line}" label="{$row.device_key_label}" perm="R">blf &lt;sip:{$row.device_key_value}@{$domain_name};user=phone&gt;|**</fkey>
			{else}
				<fkey idx="{$row.device_key_id-1}" context="{$row.device_key_line}" label="{$row.device_key_label}" perm="R">{$row.device_key_type} {$row.device_key_value} {$row.device_key_extension}</fkey>
			{/if}
		{/if}
	{else}
		<!-- {$row.device_key_id} auÃŸerhalb des Bereichs -->
	{/if}
{/foreach}
</functionKeys>

{if isset($snom_phonebook_url)}
{fetch file=''|cat:$snom_phonebook_url|cat:'&vendor=snom'}
{/if}
</settings>